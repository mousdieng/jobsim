<div class="min-h-screen bg-gray-50 py-8">
  <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8">
    <!-- Header -->
    <div class="mb-8">
      <h1 class="text-3xl font-bold text-gray-900">Create Enterprise Task</h1>
      <p class="mt-2 text-gray-600">Professional, real-world enterprise task specification</p>
    </div>

    <!-- Progress Bar -->
    <div class="mb-8 bg-white rounded-lg shadow p-6">
      <div class="flex justify-between items-center mb-4">
        <span class="text-sm font-medium text-gray-700">Step {{ currentStep }} of {{ totalSteps }}</span>
        <span class="text-sm text-gray-500">{{ Math.round((currentStep / totalSteps) * 100) }}% Complete</span>
      </div>
      <div class="w-full bg-gray-200 rounded-full h-2">
        <div
          class="bg-emerald-600 h-2 rounded-full transition-all duration-300"
          [style.width.%]="(currentStep / totalSteps) * 100"
        ></div>
      </div>
    </div>

    <!-- Form Container -->
    <div class="bg-white rounded-lg shadow">
      <form class="p-8">

        <!-- Step 1: Task Identity -->
        <div *ngIf="currentStep === 1">
          <h2 class="text-2xl font-bold text-gray-900 mb-6">1. Task Identity</h2>

          <div class="space-y-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Task Title *</label>
              <input
                type="text"
                [(ngModel)]="specification.task_identity.title"
                name="title"
                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-emerald-500 focus:border-emerald-500"
                placeholder="e.g., API Rate Limiting Implementation for Payment Gateway"
              />
            </div>

            <div class="grid grid-cols-2 gap-4">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Domain *</label>
                <input
                  type="text"
                  [(ngModel)]="specification.task_identity.domain"
                  name="domain"
                  class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-emerald-500 focus:border-emerald-500"
                  placeholder="e.g., Software Engineering"
                />
              </div>

              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Sub-Domain *</label>
                <input
                  type="text"
                  [(ngModel)]="specification.task_identity.sub_domain"
                  name="sub_domain"
                  class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-emerald-500 focus:border-emerald-500"
                  placeholder="e.g., Backend Development"
                />
              </div>
            </div>

            <div class="grid grid-cols-2 gap-4">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Difficulty Level *</label>
                <select
                  [(ngModel)]="specification.task_identity.difficulty_level"
                  name="difficulty_level"
                  class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-emerald-500 focus:border-emerald-500"
                >
                  <option value="beginner">Beginner</option>
                  <option value="intermediate">Intermediate</option>
                  <option value="advanced">Advanced</option>
                  <option value="expert">Expert</option>
                </select>
              </div>

              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Estimated Time *</label>
                <input
                  type="text"
                  [(ngModel)]="specification.task_identity.estimated_completion_time"
                  name="estimated_time"
                  class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-emerald-500 focus:border-emerald-500"
                  placeholder="e.g., 8 hours"
                />
              </div>
            </div>

            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Task Type *</label>
              <select
                [(ngModel)]="specification.task_identity.task_type"
                name="task_type"
                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-emerald-500 focus:border-emerald-500"
              >
                <option value="case_study">Case Study</option>
                <option value="hands_on">Hands-on Exercise</option>
                <option value="analysis">Analysis</option>
                <option value="simulation">Simulation</option>
                <option value="assessment">Assessment</option>
              </select>
            </div>
          </div>
        </div>

        <!-- Step 2: Business Context -->
        <div *ngIf="currentStep === 2">
          <h2 class="text-2xl font-bold text-gray-900 mb-6">2. Business Context</h2>

          <div class="space-y-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Company Context *</label>
              <textarea
                [(ngModel)]="specification.business_context.company"
                name="company"
                rows="2"
                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-emerald-500 focus:border-emerald-500"
                placeholder="e.g., FinTech Solutions Inc. - Payment processing platform serving 50,000+ merchants"
              ></textarea>
            </div>

            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Business Problem *</label>
              <textarea
                [(ngModel)]="specification.business_context.business_problem"
                name="business_problem"
                rows="3"
                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-emerald-500 focus:border-emerald-500"
                placeholder="Describe the realistic enterprise problem this task addresses"
              ></textarea>
            </div>

            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Business Impact *</label>
              <textarea
                [(ngModel)]="specification.business_context.business_impact"
                name="business_impact"
                rows="3"
                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-emerald-500 focus:border-emerald-500"
                placeholder="Why this task matters in a real company and its business impact"
              ></textarea>
            </div>

            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">Stakeholders *</label>
              <div *ngFor="let stakeholder of specification.business_context.stakeholders; let i = index" class="flex gap-2 mb-2">
                <input
                  type="text"
                  [(ngModel)]="specification.business_context.stakeholders[i]"
                  [name]="'stakeholder_' + i"
                  class="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-emerald-500 focus:border-emerald-500"
                  placeholder="e.g., Platform Engineering Team"
                />
                <button
                  type="button"
                  (click)="removeItem(specification.business_context.stakeholders, i)"
                  class="px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg"
                >
                  Remove
                </button>
              </div>
              <button
                type="button"
                (click)="addItem(specification.business_context.stakeholders)"
                class="text-emerald-600 hover:text-emerald-800 text-sm font-medium"
              >
                + Add Stakeholder
              </button>
            </div>
          </div>
        </div>

        <!-- Step 3: Task Objective -->
        <div *ngIf="currentStep === 3">
          <h2 class="text-2xl font-bold text-gray-900 mb-6">3. Task Objective</h2>

          <div class="space-y-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Goal *</label>
              <textarea
                [(ngModel)]="specification.task_objective.goal"
                name="goal"
                rows="2"
                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-emerald-500 focus:border-emerald-500"
                placeholder="What the candidate is expected to achieve"
              ></textarea>
            </div>

            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Business Outcome *</label>
              <textarea
                [(ngModel)]="specification.task_objective.business_outcome"
                name="business_outcome"
                rows="2"
                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-emerald-500 focus:border-emerald-500"
                placeholder="The business outcome of successfully completing this task"
              ></textarea>
            </div>

            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">Skills Evaluated *</label>
              <div *ngFor="let skill of specification.task_objective.skills_evaluated; let i = index" class="flex gap-2 mb-2">
                <input
                  type="text"
                  [(ngModel)]="specification.task_objective.skills_evaluated[i]"
                  [name]="'skill_' + i"
                  class="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-emerald-500 focus:border-emerald-500"
                  placeholder="e.g., Distributed system design"
                />
                <button
                  type="button"
                  (click)="removeItem(specification.task_objective.skills_evaluated, i)"
                  class="px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg"
                >
                  Remove
                </button>
              </div>
              <button
                type="button"
                (click)="addItem(specification.task_objective.skills_evaluated)"
                class="text-emerald-600 hover:text-emerald-800 text-sm font-medium"
              >
                + Add Skill
              </button>
            </div>
          </div>
        </div>

        <!-- Step 4: Scope & Constraints (Must Do) -->
        <div *ngIf="currentStep === 4">
          <h2 class="text-2xl font-bold text-gray-900 mb-6">4. Scope & Constraints (Part 1)</h2>

          <div class="space-y-6">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">Must Do *</label>
              <div *ngFor="let item of specification.scope_and_constraints.must_do; let i = index" class="flex gap-2 mb-2">
                <input
                  type="text"
                  [(ngModel)]="specification.scope_and_constraints.must_do[i]"
                  [name]="'must_do_' + i"
                  class="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-emerald-500 focus:border-emerald-500"
                  placeholder="e.g., Implement token bucket rate limiting algorithm"
                />
                <button
                  type="button"
                  (click)="removeItem(specification.scope_and_constraints.must_do, i)"
                  class="px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg"
                >
                  Remove
                </button>
              </div>
              <button
                type="button"
                (click)="addItem(specification.scope_and_constraints.must_do)"
                class="text-emerald-600 hover:text-emerald-800 text-sm font-medium"
              >
                + Add Requirement
              </button>
            </div>

            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">Must NOT Do *</label>
              <div *ngFor="let item of specification.scope_and_constraints.must_not_do; let i = index" class="flex gap-2 mb-2">
                <input
                  type="text"
                  [(ngModel)]="specification.scope_and_constraints.must_not_do[i]"
                  [name]="'must_not_do_' + i"
                  class="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-emerald-500 focus:border-emerald-500"
                  placeholder="e.g., Modify existing payment processing logic"
                />
                <button
                  type="button"
                  (click)="removeItem(specification.scope_and_constraints.must_not_do, i)"
                  class="px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg"
                >
                  Remove
                </button>
              </div>
              <button
                type="button"
                (click)="addItem(specification.scope_and_constraints.must_not_do)"
                class="text-emerald-600 hover:text-emerald-800 text-sm font-medium"
              >
                + Add Restriction
              </button>
            </div>
          </div>
        </div>

        <!-- Step 5: Scope & Constraints (Assumptions & Limits) -->
        <div *ngIf="currentStep === 5">
          <h2 class="text-2xl font-bold text-gray-900 mb-6">5. Scope & Constraints (Part 2)</h2>

          <div class="space-y-4">
            <div class="bg-gray-50 p-4 rounded-lg">
              <h3 class="text-lg font-semibold text-gray-900 mb-3">Assumptions</h3>
              <div class="space-y-3">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1">Tools Available *</label>
                  <input
                    type="text"
                    [(ngModel)]="specification.scope_and_constraints.assumptions.tools_available"
                    name="tools_available"
                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-emerald-500 focus:border-emerald-500"
                    placeholder="e.g., Node.js/Python/Java, Redis, Docker, Git"
                  />
                </div>

                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1">Data Access *</label>
                  <input
                    type="text"
                    [(ngModel)]="specification.scope_and_constraints.assumptions.data_access"
                    name="data_access"
                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-emerald-500 focus:border-emerald-500"
                    placeholder="e.g., Mock merchant tier data provided"
                  />
                </div>

                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1">Environment *</label>
                  <input
                    type="text"
                    [(ngModel)]="specification.scope_and_constraints.assumptions.environment"
                    name="environment"
                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-emerald-500 focus:border-emerald-500"
                    placeholder="e.g., Local development only"
                  />
                </div>
              </div>
            </div>

            <div class="bg-gray-50 p-4 rounded-lg">
              <h3 class="text-lg font-semibold text-gray-900 mb-3">Constraints</h3>
              <div class="space-y-3">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1">Time Limit *</label>
                  <input
                    type="text"
                    [(ngModel)]="specification.scope_and_constraints.constraints.time_limit"
                    name="time_limit"
                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-emerald-500 focus:border-emerald-500"
                    placeholder="e.g., 8 hours continuous work"
                  />
                </div>

                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1">Resource Limit *</label>
                  <input
                    type="text"
                    [(ngModel)]="specification.scope_and_constraints.constraints.resource_limit"
                    name="resource_limit"
                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-emerald-500 focus:border-emerald-500"
                    placeholder="e.g., Single Redis instance, local development machine"
                  />
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Step 6: Deliverables -->
        <div *ngIf="currentStep === 6">
          <h2 class="text-2xl font-bold text-gray-900 mb-6">6. Deliverables</h2>

          <div class="space-y-6">
            <div *ngFor="let deliverable of specification.deliverables; let i = index" class="bg-gray-50 p-4 rounded-lg">
              <div class="flex justify-between items-center mb-3">
                <h3 class="text-lg font-semibold text-gray-900">Deliverable {{ i + 1 }}</h3>
                <button
                  type="button"
                  *ngIf="specification.deliverables.length > 1"
                  (click)="removeDeliverable(i)"
                  class="text-red-600 hover:text-red-800 text-sm font-medium"
                >
                  Remove
                </button>
              </div>

              <div class="space-y-3">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1">Name *</label>
                  <input
                    type="text"
                    [(ngModel)]="deliverable.name"
                    [name]="'deliverable_name_' + i"
                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-emerald-500 focus:border-emerald-500"
                    placeholder="e.g., Source Code Repository"
                  />
                </div>

                <div class="grid grid-cols-2 gap-3">
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Format *</label>
                    <input
                      type="text"
                      [(ngModel)]="deliverable.format"
                      [name]="'deliverable_format_' + i"
                      class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-emerald-500 focus:border-emerald-500"
                      placeholder="e.g., Git repository"
                    />
                  </div>

                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Naming Convention *</label>
                    <input
                      type="text"
                      [(ngModel)]="deliverable.naming"
                      [name]="'deliverable_naming_' + i"
                      class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-emerald-500 focus:border-emerald-500"
                      placeholder="e.g., rate-limiter-[candidate-id]"
                    />
                  </div>
                </div>

                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">Requirements *</label>
                  <div *ngFor="let req of deliverable.requirements; let j = index" class="flex gap-2 mb-2">
                    <input
                      type="text"
                      [(ngModel)]="deliverable.requirements[j]"
                      [name]="'deliverable_req_' + i + '_' + j"
                      class="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-emerald-500 focus:border-emerald-500"
                      placeholder="e.g., Complete implementation with clear commit history"
                    />
                    <button
                      type="button"
                      (click)="removeItem(deliverable.requirements, j)"
                      class="px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg"
                    >
                      Remove
                    </button>
                  </div>
                  <button
                    type="button"
                    (click)="addItem(deliverable.requirements)"
                    class="text-emerald-600 hover:text-emerald-800 text-sm font-medium"
                  >
                    + Add Requirement
                  </button>
                </div>
              </div>
            </div>

            <button
              type="button"
              (click)="addDeliverable()"
              class="w-full py-3 border-2 border-dashed border-gray-300 rounded-lg text-gray-600 hover:border-emerald-500 hover:text-emerald-600 transition-colors"
            >
              + Add Another Deliverable
            </button>
          </div>
        </div>

        <!-- Step 7: Evaluation Criteria -->
        <div *ngIf="currentStep === 7">
          <h2 class="text-2xl font-bold text-gray-900 mb-6">7. Evaluation Criteria</h2>

          <div class="space-y-6">
            <div *ngFor="let key of getCriterionKeys()" class="bg-gray-50 p-4 rounded-lg">
              <div class="flex justify-between items-center mb-3">
                <input
                  type="text"
                  [value]="key"
                  disabled
                  class="text-lg font-semibold text-gray-900 bg-transparent border-none"
                  placeholder="Criterion Name"
                />
                <button
                  type="button"
                  (click)="removeCriterion(key)"
                  class="text-red-600 hover:text-red-800 text-sm font-medium"
                >
                  Remove
                </button>
              </div>

              <div class="space-y-3">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1">Weight *</label>
                  <input
                    type="text"
                    [(ngModel)]="specification.evaluation_criteria[key].weight"
                    [name]="'criterion_weight_' + key"
                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-emerald-500 focus:border-emerald-500"
                    placeholder="e.g., 40%"
                  />
                </div>

                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">Success Indicators *</label>
                  <div *ngFor="let indicator of specification.evaluation_criteria[key].indicators; let i = index" class="flex gap-2 mb-2">
                    <input
                      type="text"
                      [(ngModel)]="specification.evaluation_criteria[key].indicators[i]"
                      [name]="'criterion_indicator_' + key + '_' + i"
                      class="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-emerald-500 focus:border-emerald-500"
                      placeholder="e.g., Rate limiting algorithm correctly implemented"
                    />
                    <button
                      type="button"
                      (click)="removeItem(specification.evaluation_criteria[key].indicators, i)"
                      class="px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg"
                    >
                      Remove
                    </button>
                  </div>
                  <button
                    type="button"
                    (click)="addItem(specification.evaluation_criteria[key].indicators)"
                    class="text-emerald-600 hover:text-emerald-800 text-sm font-medium"
                  >
                    + Add Indicator
                  </button>
                </div>
              </div>
            </div>

            <button
              type="button"
              (click)="addCriterion()"
              class="w-full py-3 border-2 border-dashed border-gray-300 rounded-lg text-gray-600 hover:border-emerald-500 hover:text-emerald-600 transition-colors"
            >
              + Add Evaluation Criterion
            </button>
          </div>
        </div>

        <!-- Step 8: Validation Rules -->
        <div *ngIf="currentStep === 8">
          <h2 class="text-2xl font-bold text-gray-900 mb-6">8. Validation Rules</h2>

          <div class="space-y-6">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">Minimum Requirements *</label>
              <div *ngFor="let req of specification.validation_rules.minimum_requirements; let i = index" class="flex gap-2 mb-2">
                <input
                  type="text"
                  [(ngModel)]="specification.validation_rules.minimum_requirements[i]"
                  [name]="'min_req_' + i"
                  class="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-emerald-500 focus:border-emerald-500"
                  placeholder="e.g., Code compiles/runs without errors"
                />
                <button
                  type="button"
                  (click)="removeItem(specification.validation_rules.minimum_requirements, i)"
                  class="px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg"
                >
                  Remove
                </button>
              </div>
              <button
                type="button"
                (click)="addItem(specification.validation_rules.minimum_requirements)"
                class="text-emerald-600 hover:text-emerald-800 text-sm font-medium"
              >
                + Add Requirement
              </button>
            </div>

            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">Automatic Rejection Conditions *</label>
              <div *ngFor="let condition of specification.validation_rules.automatic_rejection; let i = index" class="flex gap-2 mb-2">
                <input
                  type="text"
                  [(ngModel)]="specification.validation_rules.automatic_rejection[i]"
                  [name]="'auto_reject_' + i"
                  class="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-emerald-500 focus:border-emerald-500"
                  placeholder="e.g., Code contains hardcoded credentials or secrets"
                />
                <button
                  type="button"
                  (click)="removeItem(specification.validation_rules.automatic_rejection, i)"
                  class="px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg"
                >
                  Remove
                </button>
              </div>
              <button
                type="button"
                (click)="addItem(specification.validation_rules.automatic_rejection)"
                class="text-emerald-600 hover:text-emerald-800 text-sm font-medium"
              >
                + Add Condition
              </button>
            </div>

            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">Compliance Checks *</label>
              <div *ngFor="let check of specification.validation_rules.compliance_checks; let i = index" class="flex gap-2 mb-2">
                <input
                  type="text"
                  [(ngModel)]="specification.validation_rules.compliance_checks[i]"
                  [name]="'compliance_' + i"
                  class="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-emerald-500 focus:border-emerald-500"
                  placeholder="e.g., Uses allowed technology stack only"
                />
                <button
                  type="button"
                  (click)="removeItem(specification.validation_rules.compliance_checks, i)"
                  class="px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg"
                >
                  Remove
                </button>
              </div>
              <button
                type="button"
                (click)="addItem(specification.validation_rules.compliance_checks)"
                class="text-emerald-600 hover:text-emerald-800 text-sm font-medium"
              >
                + Add Check
              </button>
            </div>
          </div>
        </div>

        <!-- Step 9: Visibility & Access -->
        <div *ngIf="currentStep === 9">
          <h2 class="text-2xl font-bold text-gray-900 mb-6">9. Visibility & Access Rules</h2>

          <div class="space-y-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">Eligible Domains *</label>
              <div *ngFor="let domain of specification.visibility_and_access.eligible_domains; let i = index" class="flex gap-2 mb-2">
                <input
                  type="text"
                  [(ngModel)]="specification.visibility_and_access.eligible_domains[i]"
                  [name]="'eligible_domain_' + i"
                  class="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-emerald-500 focus:border-emerald-500"
                  placeholder="e.g., Software Engineering"
                />
                <button
                  type="button"
                  (click)="removeItem(specification.visibility_and_access.eligible_domains, i)"
                  class="px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg"
                >
                  Remove
                </button>
              </div>
              <button
                type="button"
                (click)="addItem(specification.visibility_and_access.eligible_domains)"
                class="text-emerald-600 hover:text-emerald-800 text-sm font-medium"
              >
                + Add Domain
              </button>
            </div>

            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Student Level Restriction *</label>
              <input
                type="text"
                [(ngModel)]="specification.visibility_and_access.student_level"
                name="student_level"
                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-emerald-500 focus:border-emerald-500"
                placeholder="e.g., Intermediate and above"
              />
            </div>

            <div class="bg-gray-50 p-4 rounded-lg">
              <h3 class="text-lg font-semibold text-gray-900 mb-3">Enterprise Visibility</h3>
              <div class="space-y-3">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1">Submissions Access *</label>
                  <input
                    type="text"
                    [(ngModel)]="specification.visibility_and_access.enterprise_visibility.submissions"
                    name="enterprise_submissions"
                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-emerald-500 focus:border-emerald-500"
                    placeholder="e.g., Enterprise who created task + Admin"
                  />
                </div>

                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1">Candidate Identity *</label>
                  <input
                    type="text"
                    [(ngModel)]="specification.visibility_and_access.enterprise_visibility.candidate_identity"
                    name="candidate_identity"
                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-emerald-500 focus:border-emerald-500"
                    placeholder="e.g., Anonymized until evaluation complete"
                  />
                </div>
              </div>
            </div>

            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Support Visibility *</label>
              <input
                type="text"
                [(ngModel)]="specification.visibility_and_access.support_visibility"
                name="support_visibility"
                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-emerald-500 focus:border-emerald-500"
                placeholder="e.g., Read-only access to task description only"
              />
            </div>
          </div>
        </div>

        <!-- Step 10: Optional Enhancements -->
        <div *ngIf="currentStep === 10">
          <h2 class="text-2xl font-bold text-gray-900 mb-6">10. Optional Enhancements</h2>

          <div class="space-y-6">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">Reference Documents</label>
              <div *ngFor="let doc of specification.optional_enhancements?.reference_documents || []; let i = index" class="flex gap-2 mb-2">
                <input
                  type="text"
                  [(ngModel)]="specification.optional_enhancements!.reference_documents![i]"
                  [name]="'ref_doc_' + i"
                  class="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-emerald-500 focus:border-emerald-500"
                  placeholder="e.g., RFC 6585 - Additional HTTP Status Codes"
                />
                <button
                  type="button"
                  (click)="removeItem(specification.optional_enhancements!.reference_documents!, i)"
                  class="px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg"
                >
                  Remove
                </button>
              </div>
              <button
                type="button"
                (click)="addItem(specification.optional_enhancements?.reference_documents || (specification.optional_enhancements!.reference_documents = []))"
                class="text-emerald-600 hover:text-emerald-800 text-sm font-medium"
              >
                + Add Document
              </button>
            </div>

            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Sample Data</label>
              <input
                type="text"
                [(ngModel)]="specification.optional_enhancements!.sample_data"
                name="sample_data"
                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-emerald-500 focus:border-emerald-500"
                placeholder="e.g., merchant_tiers.json with 100 sample merchant configurations"
              />
            </div>

            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">Clarification FAQ</label>
              <div *ngFor="let key of getFaqKeys()" class="bg-gray-50 p-3 rounded-lg mb-2">
                <div class="flex justify-between items-start mb-2">
                  <input
                    type="text"
                    [value]="key"
                    disabled
                    class="font-medium text-gray-700 bg-transparent border-none"
                  />
                  <button
                    type="button"
                    (click)="removeFaqItem(key)"
                    class="text-red-600 hover:text-red-800 text-sm"
                  >
                    Remove
                  </button>
                </div>
                <textarea
                  [(ngModel)]="specification.optional_enhancements!.clarification_faq![key]"
                  [name]="'faq_' + key"
                  rows="2"
                  class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-emerald-500 focus:border-emerald-500"
                  placeholder="Answer"
                ></textarea>
              </div>
              <button
                type="button"
                (click)="addFaqItem()"
                class="text-emerald-600 hover:text-emerald-800 text-sm font-medium"
              >
                + Add FAQ Item
              </button>
            </div>

            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">Bonus Challenges</label>
              <div *ngFor="let bonus of specification.optional_enhancements?.bonus_challenges || []; let i = index" class="flex gap-2 mb-2">
                <input
                  type="text"
                  [(ngModel)]="specification.optional_enhancements!.bonus_challenges![i]"
                  [name]="'bonus_' + i"
                  class="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-emerald-500 focus:border-emerald-500"
                  placeholder="e.g., Implement burst allowance for tier upgrades"
                />
                <button
                  type="button"
                  (click)="removeItem(specification.optional_enhancements!.bonus_challenges!, i)"
                  class="px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg"
                >
                  Remove
                </button>
              </div>
              <button
                type="button"
                (click)="addItem(specification.optional_enhancements?.bonus_challenges || (specification.optional_enhancements!.bonus_challenges = []))"
                class="text-emerald-600 hover:text-emerald-800 text-sm font-medium"
              >
                + Add Bonus Challenge
              </button>
            </div>
          </div>
        </div>

        <!-- Navigation Buttons -->
        <div class="flex justify-between mt-8 pt-6 border-t border-gray-200">
          <button
            type="button"
            *ngIf="currentStep > 1"
            (click)="prevStep()"
            class="px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"
          >
            Previous
          </button>

          <div class="ml-auto flex gap-3">
            <button
              type="button"
              (click)="cancel()"
              class="px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"
            >
              Cancel
            </button>

            <button
              type="button"
              *ngIf="currentStep === totalSteps"
              (click)="saveAsDraft()"
              [disabled]="loading"
              class="px-6 py-2 border border-emerald-600 text-emerald-600 rounded-lg hover:bg-emerald-50 transition-colors disabled:opacity-50"
            >
              Save as Draft
            </button>

            <button
              type="button"
              *ngIf="currentStep < totalSteps"
              (click)="nextStep()"
              class="px-6 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors"
            >
              Next
            </button>

            <button
              type="button"
              *ngIf="currentStep === totalSteps"
              (click)="publish()"
              [disabled]="loading"
              class="px-6 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors disabled:opacity-50"
            >
              <span *ngIf="!loading">Publish Task</span>
              <span *ngIf="loading">Publishing...</span>
            </button>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>
