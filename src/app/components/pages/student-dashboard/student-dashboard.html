<div *ngIf="user" class="p-4 sm:p-8 bg-white shadow-2xl rounded-xl">
  <h1 class="text-4xl font-extrabold text-gray-900 mb-2">Welcome Back, {{ user.name }}</h1>
  <p class="text-xl text-gray-600 mb-8">Role: <span class="font-semibold text-green-600">{{ user.role }}</span></p>

  <!-- Gamification & Metrics Grid -->
  <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-10">
    <div class="p-5 bg-indigo-50 rounded-xl border border-indigo-200">
      <p class="text-sm font-medium text-indigo-700">Total Portfolio Score</p>
      <p class="text-4xl font-black text-indigo-900 mt-2">{{ user.score_total }}</p>
    </div>
    <div class="p-5 bg-purple-50 rounded-xl border border-purple-200">
      <p class="text-sm font-medium text-purple-700">Simulations Completed</p>
      <p class="text-4xl font-black text-purple-900 mt-2">{{ user.completed_count }}</p>
    </div>
    <div class="p-5 bg-green-50 rounded-xl border border-green-200 flex flex-col justify-center">
      <p class="text-sm font-medium text-green-700 mb-1">Current Achievement Badge</p>
      <app-badge [level]="user.badge_level || 'Beginner'"></app-badge>
    </div>
  </div>

  <!-- Profile Call-to-Action Buttons -->
  <h2 class="text-2xl font-bold text-gray-800 border-b pb-3 mb-6">Career Actions</h2>
  <div class="flex flex-wrap gap-4 mb-10">
    <button
      (click)="promoteProfile()"
      class="bg-red-600 text-white font-semibold py-2 px-6 rounded-lg shadow-lg hover:bg-red-700 transition transform hover:scale-[1.02]"
    >
      Give Me a Chance!
    </button>
    <a
      [href]="user.linked_profile"
      target="_blank"
      rel="noopener noreferrer"
      class="bg-blue-600 text-white font-semibold py-2 px-6 rounded-lg shadow-lg hover:bg-blue-700 transition transform hover:scale-[1.02]"
    >
      See My Linked Profile
    </a>
    <a
      [href]="'mailto:' + user.contact_email"
      class="bg-gray-200 text-gray-800 font-semibold py-2 px-6 rounded-lg shadow-lg hover:bg-gray-300 transition transform hover:scale-[1.02]"
    >
      Contact Me
    </a>
  </div>

  <!-- Submissions List -->
  <h2 class="text-2xl font-bold text-gray-800 border-b pb-3 mb-6">Your Simulation History</h2>

  <div class="space-y-4">
    <div
      *ngFor="let sub of submissions"
      class="p-5 bg-white border border-gray-200 rounded-xl shadow-md flex flex-col sm:flex-row justify-between items-start sm:items-center hover:bg-gray-50 transition"
    >
      <div class="flex-1 min-w-0 mb-3 sm:mb-0">
        <p class="text-lg font-semibold text-gray-900 truncate">{{ sub.title }}</p>
        <p class="text-sm text-gray-500">Submitted: {{ sub.submitted_at | date:'mediumDate' }}</p>
        <p class="text-xs font-medium text-blue-600 mt-1">{{ sub.category }}</p>
      </div>
      <div class="text-right flex items-center space-x-4">
        <ng-container *ngIf="sub.score !== null; else awaiting">
          <div class="text-center">
            <p class="text-2xl font-bold text-green-600">
              {{ sub.score }}<span class="text-base text-gray-600">/100</span>
            </p>
            <p class="text-xs font-medium text-green-700">Reviewed</p>
          </div>
          <button
            (click)="showFeedback(sub)"
            class="bg-blue-500 text-white px-3 py-1.5 rounded-lg text-sm font-medium hover:bg-blue-600 transition"
          >
            View Feedback
          </button>
        </ng-container>
        <ng-template #awaiting>
          <div class="text-center">
            <p class="text-2xl font-bold text-yellow-600">--</p>
            <p class="text-xs font-medium text-yellow-700">Awaiting Review</p>
          </div>
        </ng-template>
      </div>
    </div>
  </div>
</div>
